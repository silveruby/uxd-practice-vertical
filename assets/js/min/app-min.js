!function(){var e=angular.module("uxdpv",["firebase","duScroll"]);e.directive("messageBox",function(){return{restrict:"E",templateUrl:"/templates/messageBox.html"}}),e.directive("practiceVerticals",function(){return{restrict:"E",templateUrl:"/templates/practiceVerticals.html"}}),e.directive("learnMore",function(){return{restrict:"E",templateUrl:"/templates/learnMore.html"}}),e.directive("aboutSite",function(){return{restrict:"E",templateUrl:"/templates/aboutSite.html"}}),e.config(["$locationProvider",function(e){e.html5Mode(!0)}]),e.factory("myFireBase",["$firebaseObject","$firebaseAuth",function(e,t){var s="https://torrid-inferno-2523.firebaseio.com/";return{auth:function(){var e=new Firebase(s);return t(e)},obj:function(t){var o=new Firebase(s+t);return e(o)}}}]),e.controller("mainController",["$scope","$location","$http","myFireBase",function(e,t,s,o){var r=e;r.current_state="",r.current_status="",r.current_link="http://www.uxdpv.io/?email=",r.shareUrl={facebook:"",twitter:"",linkedin:""},r.selected_count=0,r.pv1=[],r.pv2=[],r.select=[],r.msgBox={user:"",email:"",link:"",password:""},r.init=function(){r.loc=t.path("/").search(),void 0!=r.loc.email&&""!=r.loc.email?(r.msgBox.email=r.loc.email,o.obj(r.normalizeEmail(r.msgBox.email)).$loaded().then(function(e){if(null===e.$value)r.msgBox.link=r.current_link+r.loc.email,r.loadDefaultSelection("is_error");else{r.select=e.select,r.msgBox.user=e.name,r.msgBox.link=r.current_link+r.loc.email;for(pv in r.select)for(a in r.select[pv])r.select[pv][a]&&r.selected_count++;r.goToState("s4","is_default")}})["catch"](function(e){r.msgBox.link=r.msgBox.link+r.loc.email,r.loadDefaultSelection("is_error")})):r.loadDefaultSelection("is_default"),r.populatePV()},r.toggleSelected=function(e,t,s){if("s1"==r.current_state||"s2"==r.current_state||"s7"==r.current_state){var o,a,n,i,l,c;o=document.querySelector("."+s.ClassName),c=o.getBoundingClientRect(),a=e.clientX-c.left,n=e.clientY-c.top,i=$("."+s.ClassName+" .ripple").width(),l=$("."+s.ClassName+" .ripple").height(),a-=i/2,n-=l/2,$("."+s.ClassName+" .ripple").css({top:n+"px",left:a+"px"}),$("."+s.ClassName+" .ripple").removeClass("selected").width(),$("."+s.ClassName+" .ripple").addClass("selected"),r.select[t.ClassName][s.ClassName]=!r.select[t.ClassName][s.ClassName],r.select[t.ClassName][s.ClassName]?r.selected_count++:r.selected_count--,"s1"==r.current_state&&r.selected_count>0?r.goToState("s2","is_default"):"s2"==r.current_state&&0==r.selected_count&&r.goToState("s1","is_default")}},r.createUserLink=function(){r.msgBox.password="uxdpv",r.msgBox.email=r.newEmail,r.msgBox.user=r.newName,r.msgBox.link=r.current_link+r.msgBox.email,auth=o.auth(),auth.$createUser({email:r.msgBox.email,password:r.msgBox.password}).then(function(e){normalizeEmail=r.normalizeEmail(r.msgBox.email),obj=o.obj(normalizeEmail),userSelectionJSON=r.select,angular.fromJson(angular.toJson(userSelectionJSON)),obj.select=userSelectionJSON,obj.name=r.msgBox.user,obj.$save().then(function(){r.goToState("s3","is_default")},function(e){$(".card-confirmation .error .msg").html("<strong>"+e+"</strong>"),r.goToState("s3","is_error")})})["catch"](function(e){$(".card-confirmation .error .msg").html("<strong>"+e+"</strong>"),r.goToState("s3","is_error")})},r.popShareUrl=function(e){e.preventDefault(),console.log(e);var t="500";intHeight="400",strResize="no",strTitle=e.title,strParam="width="+t+",height="+intHeight+",resizable="+strResize,objWindow=window.open(e.currentTarget,strTitle,strParam).focus()},r.authenticateUser=function(){o.auth().$authWithPassword({email:r.msgBox.email,password:r.userPassword}).then(function(e){r.goToState("s7","is_default")})["catch"](function(e){$(".card-authenticate .error .msg").html("<strong>"+e+"</strong>"),r.goToState("s5","is_error")})},r.resetUserPassword=function(){o.auth().$resetPassword({email:r.msgBox.email}).then(function(e){$(".card-reset .success").show(),$(".card-reset .default").hide()})["catch"](function(e){$(".card-reset .error").show(),$(".card-reset .default").hide()})},r.saveChanges=function(){normalizeEmail=r.normalizeEmail(r.msgBox.email),obj=o.obj(normalizeEmail),userSelectionJSON=r.select,angular.fromJson(angular.toJson(userSelectionJSON)),obj.select=userSelectionJSON,obj.name=r.msgBox.user,obj.$save().then(function(){r.goToState("s8","is_default")},function(e){r.goToState("s8","is_error")})},r.populatePV=function(){s.get("/./assets/js/uxd-practice-verticals.json").success(function(e){r.pv1=e.slice(0,4),r.pv2=e.slice(4,8)}).error(function(){})},r.loadDefaultSelection=function(e){s.get("/./assets/js/default-selection.json").success(function(t){r.select=t,r.selected_count=0;for(pv in r.select)for(a in r.select[pv])r.select[pv][a]&&r.selected_count++;r.goToState("s1",e)}).error(function(){r.goToState("s1","is_error")})},r.goToState=function(e,t){r.current_state=e,r.current_status=t},r.normalizeEmail=function(e){return e.replace(/[^a-zA-Z0-9]/g,"-")},r.generatePassword=function(){for(var e=5,t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",s="",o=0,r=t.length;e>o;++o)s+=t.charAt(Math.floor(Math.random()*r));return s},angular.element(document).ready(function(){r.init()})}])}();