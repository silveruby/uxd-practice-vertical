!function(){var e=angular.module("uxdpv",["firebase","duScroll"]);e.directive("messageBox",function(){return{restrict:"E",templateUrl:"/templates/messageBox.html"}}),e.directive("practiceVerticals",function(){return{restrict:"E",templateUrl:"/templates/practiceVerticals.html"}}),e.directive("learnMore",function(){return{restrict:"E",templateUrl:"/templates/learnMore.html"}}),e.directive("aboutSite",function(){return{restrict:"E",templateUrl:"/templates/aboutSite.html"}}),e.config(["$locationProvider",function(e){e.html5Mode(!0)}]),e.factory("myFireBase",["$firebaseObject","$firebaseAuth",function(e,t){var a="https://torrid-inferno-2523.firebaseio.com/";return{auth:function(){var e=new Firebase(a);return t(e)},obj:function(t){var s=new Firebase(a+t);return e(s)}}}]),e.controller("mainController",["$scope","$location","$http","myFireBase",function(e,t,s,r){var o=e;o.current_state="",o.current_status="",o.current_link="http://www.uxdpv.io/?email=",o.selected_count=0,o.pv1=[],o.pv2=[],o.select=[],o.msgBox={user:"",email:"",link:"",password:""},o.init=function(){o.loc=t.path("/").search(),void 0!=o.loc.email&&""!=o.loc.email?(o.msgBox.email=o.loc.email,r.obj(o.normalizeEmail(o.msgBox.email)).$loaded().then(function(e){if(null===e.$value)o.msgBox.link=o.current_link+o.loc.email,o.loadDefaultSelection("is_error");else{o.select=e.select,o.msgBox.user=e.name,o.msgBox.link=o.current_link+o.loc.email;for(pv in o.select)for(a in o.select[pv])o.select[pv][a]&&o.selected_count++;o.goToState("s4","is_default")}})["catch"](function(e){o.msgBox.link=o.msgBox.link+o.loc.email,o.loadDefaultSelection("is_error")})):o.loadDefaultSelection("is_default"),o.populatePV()},o.toggleSelected=function(e,t,a){if("s1"==o.current_state||"s2"==o.current_state||"s7"==o.current_state){var s,r,n,l,i,c;s=document.querySelector("."+a.ClassName),c=s.getBoundingClientRect(),r=e.clientX-c.left,n=e.clientY-c.top,l=$("."+a.ClassName+" .ripple").width(),i=$("."+a.ClassName+" .ripple").height(),r-=l/2,n-=i/2,$("."+a.ClassName+" .ripple").css({top:n+"px",left:r+"px"}),$("."+a.ClassName+" .ripple").removeClass("selected").width(),$("."+a.ClassName+" .ripple").addClass("selected"),o.select[t.ClassName][a.ClassName]=!o.select[t.ClassName][a.ClassName],o.select[t.ClassName][a.ClassName]?o.selected_count++:o.selected_count--,"s1"==o.current_state&&o.selected_count>0?o.goToState("s2","is_default"):"s2"==o.current_state&&0==o.selected_count&&o.goToState("s1","is_default")}},o.createUserLink=function(){o.msgBox.password="uxdpv",o.msgBox.email=o.newEmail,o.msgBox.user=o.newName,o.msgBox.link=o.current_link+o.msgBox.email,auth=r.auth(),auth.$createUser({email:o.msgBox.email,password:o.msgBox.password}).then(function(e){normalizeEmail=o.normalizeEmail(o.msgBox.email),obj=r.obj(normalizeEmail),userSelectionJSON=o.select,angular.fromJson(angular.toJson(userSelectionJSON)),obj.select=userSelectionJSON,obj.name=o.msgBox.user,obj.$save().then(function(){o.goToState("s3","is_default")},function(e){$(".card-confirmation .error .msg").html("<strong>"+e+"</strong>"),o.goToState("s3","is_error")})})["catch"](function(e){$(".card-confirmation .error .msg").html("<strong>"+e+"</strong>"),o.goToState("s3","is_error")})},o.authenticateUser=function(){r.auth().$authWithPassword({email:o.msgBox.email,password:o.userPassword}).then(function(e){o.goToState("s7","is_default")})["catch"](function(e){$(".card-authenticate .error .msg").html("<strong>"+e+"</strong>"),o.goToState("s5","is_error")})},o.resetUserPassword=function(){r.auth().$resetPassword({email:o.msgBox.email}).then(function(e){$(".card-reset .success").show(),$(".card-reset .default").hide()})["catch"](function(e){$(".card-reset .error").show(),$(".card-reset .default").hide()})},o.saveChanges=function(){normalizeEmail=o.normalizeEmail(o.msgBox.email),obj=r.obj(normalizeEmail),userSelectionJSON=o.select,angular.fromJson(angular.toJson(userSelectionJSON)),obj.select=userSelectionJSON,obj.name=o.msgBox.user,obj.$save().then(function(){o.goToState("s8","is_default")},function(e){o.goToState("s8","is_error")})},o.populatePV=function(){s.get("/./assets/js/uxd-practice-verticals.json").success(function(e){o.pv1=e.slice(0,4),o.pv2=e.slice(4,8)}).error(function(){})},o.loadDefaultSelection=function(e){s.get("/./assets/js/default-selection.json").success(function(t){o.select=t,o.selected_count=0;for(pv in o.select)for(a in o.select[pv])o.select[pv][a]&&o.selected_count++;o.goToState("s1",e)}).error(function(){o.goToState("s1","is_error")})},o.goToState=function(e,t){switch(o.current_state=e,o.current_status=t,$(".fade").removeClass("fadein"),e){case"s1":$(".card-default").addClass("fadein");break;case"s2":$(".card-save").addClass("fadein");break;case"s3":$(".card-confirmation").addClass("fadein");break;case"s4":$(".card-user").addClass("fadein");break;case"s5":$(".card-authenticate").addClass("fadein");break;case"s6":$(".card-reset").addClass("fadein");break;case"s7":$(".card-modify").addClass("fadein");break;case"s8":$(".card-updated").addClass("fadein")}},o.normalizeEmail=function(e){return e.replace(/[^a-zA-Z0-9]/g,"-")},o.generatePassword=function(){for(var e=5,t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",a="",s=0,r=t.length;e>s;++s)a+=t.charAt(Math.floor(Math.random()*r));return a},angular.element(document).ready(function(){o.init()})}])}();