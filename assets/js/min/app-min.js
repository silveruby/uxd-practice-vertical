!function(){var e=angular.module("uxdpv",["firebase"]);e.directive("practiceVerticals",function(){return{restrict:"E",templateUrl:"practiceVerticals.html"}}),e.config(["$locationProvider",function(e){e.html5Mode(!0)}]),e.factory("myFireBase",["$firebaseObject","$firebaseAuth",function(e,t){var o="https://torrid-inferno-2523.firebaseio.com/";return{auth:function(){var e=new Firebase(o);return t(e)},obj:function(t){var s=new Firebase(o+t);return e(s)}}}]),e.controller("mainController",["$scope","$location","$http","myFireBase",function(e,t,o,s){var n=e;n.current_state="",n.selected_count=0,n.pv1=[],n.pv2=[],n.select=[],n.init=function(){n.loc=t.path("/").search(),console.log(n.loc.email),n.populatePV(),void 0!=n.loc.email?s.auth().$authWithPassword({email:n.loc.email,password:"nopassword"}).then(function(e){console.log("Logged in as:",e.uid),s.obj(e.uid).$loaded().then(function(e){if(null===e.$value)n.loadDefaultSelection();else{n.select=e;for(pv in n.select)for(a in n.select[pv])n.select[pv][a]&&n.selected_count++;n.goToState("s4")}})["catch"](function(e){console.log("User does not exist"),n.loadDefaultSelection()})})["catch"](function(e){console.log("UserID Select Object does not exist"),n.loadDefaultSelection()}):n.loadDefaultSelection()},n.toggleSelected=function(e,t,o){if("s1"==n.current_state||"s2"==n.current_state||"s6"==n.current_state){var s,a,c,r,l,i;s=document.querySelector("."+o.ClassName),i=s.getBoundingClientRect(),a=e.clientX-i.left,c=e.clientY-i.top,r=$("."+o.ClassName+" .ripple").width(),l=$("."+o.ClassName+" .ripple").height(),a-=r/2,c-=l/2,$("."+o.ClassName+" .ripple").css({top:c+"px",left:a+"px"}),$("."+o.ClassName+" .ripple").removeClass("selected").width(),$("."+o.ClassName+" .ripple").addClass("selected"),n.select[t.ClassName][o.ClassName]=!n.select[t.ClassName][o.ClassName],n.select[t.ClassName][o.ClassName]?n.selected_count++:n.selected_count--,(n.current_state=n.selected_count>0)&&n.goToState("s2")}},n.createUserLink=function(){auth=s.auth(),auth.$createUser({email:n.newEmail,password:"nopassword"}).then(function(e){console.log("User "+e.uid+" created successfully!"),obj=s.obj(e.uid),userSelectionJSON=n.select,angular.fromJson(angular.toJson(userSelectionJSON)),console.log(obj),obj.$ref().set(userSelectionJSON,function(e){e?($(".card-confirmation .error .msg").html("<strong>"+e+"</strong>"),$(".card-confirmation .success").hide(),$(".card-confirmation .error").show()):($(".card-confirmation .success").show(),$(".card-confirmation .error").hide())})})["catch"](function(e){console.log("Error: ",e),$(".card-confirmation .error .msg").html("<strong>"+e+"</strong>"),$(".card-confirmation .success").hide(),$(".card-confirmation .error").show()}),n.goToState("s3")},n.modifyChart=function(){},n.authenticateUser=function(){console.log("User email: "+n.userEmail),auth=s.auth(),auth.$authWithPassword({email:n.userEmail,password:"nopassword"}).then(function(e){console.log("Logged in as:",e.uid),n.goToState("s6")})["catch"](function(e){console.error("Authentication failed:",e),$(".card-authenticate .error .msg").html("<strong>"+e+"</strong>"),$(".card-authenticate .form").hide(),$(".card-authenticate .error").show()})},n.resetUserPassword=function(){console.log("User email: "+n.userEmail),console.log("User password: "+n.userPassword),auth=s.auth(),auth.$authWithPassword({email:n.userEmail,password:n.userPassword}).then(function(e){console.log("Logged in as:",e.uid),n.goToState("s6")})["catch"](function(e){n.goToState("s6"),console.error("Authentication failed:",e)})},n.saveChanges=function(){},n.populatePV=function(){o.get("/./assets/js/uxd-practice-verticals.json").success(function(e){console.log("success"),n.pv1=e.slice(0,4),n.pv2=e.slice(4,8)}).error(function(){console.log("Error: cannot get default PVs")})},n.loadDefaultSelection=function(){n.goToState("s1"),o.get("/./assets/js/default-selection.json").success(function(e){n.select=e,n.selected_count=0;for(pv in n.select)for(a in n.select[pv])n.select[pv][a]&&n.selected_count++;console.log("using default selection")}).error(function(){console.log("error with default selection")})},n.goToState=function(e){switch(n.current_state=e,console.log("current state: "+n.current_state),$(".fade").removeClass("fadein"),e){case"s1":$(".card-default").addClass("fadein");break;case"s2":$(".card-save").addClass("fadein");break;case"s3":$(".card-confirmation").addClass("fadein");break;case"s4":console.log("state 4"),$(".messageBox .card-user").addClass("fadein");break;case"s5":$(".card-authenticate").addClass("fadein");break;case"s6":$(".card-modify").addClass("fadein")}},n.generatePassword=function(){for(var e=8,t="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789",o="",s=0,a=t.length;e>s;++s)o+=t.charAt(Math.floor(Math.random()*a));return o},n.init()}])}();